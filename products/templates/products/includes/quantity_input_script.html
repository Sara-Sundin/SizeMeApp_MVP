<script type="text/javascript">
    // Disable +/- buttons outside 1-99 range
    function handleEnableDisable(itemId) {
        const qtyInput = document.getElementById(`id_qty_${itemId}`);
        const currentValue = parseInt(qtyInput.value);
        const minusBtn = document.getElementById(`decrement-qty_${itemId}`);
        const plusBtn = document.getElementById(`increment-qty_${itemId}`);

        minusBtn.disabled = currentValue < 2;
        plusBtn.disabled = currentValue > 98;
    }

    // Wait until the DOM is fully loaded
    document.addEventListener("DOMContentLoaded", function () {
        const allQtyInputs = document.querySelectorAll('.qty_input');

        // Initial setup
        allQtyInputs.forEach((input) => {
            const itemId = input.dataset.item_id;
            handleEnableDisable(itemId);
        });

        // When input changes
        allQtyInputs.forEach((input) => {
            input.addEventListener('change', function () {
                const itemId = this.dataset.item_id;
                handleEnableDisable(itemId);
            });
        });

        // Increment buttons
        const incrementBtns = document.querySelectorAll('.increment-qty');
        incrementBtns.forEach((btn) => {
            btn.addEventListener('click', function (e) {
                e.preventDefault();
                const itemId = this.dataset.item_id;
                const input = document.getElementById(`id_qty_${itemId}`);
                let value = parseInt(input.value) || 0;
                input.value = value + 1;
                handleEnableDisable(itemId);
            });
        });

        // Decrement buttons
        const decrementBtns = document.querySelectorAll('.decrement-qty');
        decrementBtns.forEach((btn) => {
            btn.addEventListener('click', function (e) {
                e.preventDefault();
                const itemId = this.dataset.item_id;
                const input = document.getElementById(`id_qty_${itemId}`);
                let value = parseInt(input.value) || 0;
                input.value = value - 1;
                handleEnableDisable(itemId);
            });
        });
    });
</script>
